com.example.mymuzic/
â”‚
â”œâ”€â”€ di/                     <- Koin/Hilt module
â”‚   â””â”€â”€ AppModule.kt
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ model/             <- Dá»¯ liá»‡u thÃ´ tá»« API (DTO)
â”‚   â”œâ”€â”€ remote/            <- API interface (Retrofit/Ktor)
â”‚   â””â”€â”€ repository/        <- Triá»ƒn khai repository
â”‚
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ model/             <- Dá»¯ liá»‡u dÃ¹ng trong app (UI model)
â”‚   â”œâ”€â”€ repository/        <- Interface repository
â”‚   â””â”€â”€ usecase/           <- Business logic
â”‚
â”œâ”€â”€ presentation/
â”‚   â”œâ”€â”€ navigation/        <- NavHost, route names
â”‚   â”œâ”€â”€ screen/
â”‚   â”‚   â””â”€â”€ home/          <- UI + ViewModel mÃ n home
â”‚   â””â”€â”€ ui/                <- Component tÃ¡i sá»­ dá»¥ng (PlayerControl, TrackCard,â€¦)
â”‚
â”œâ”€â”€ MainActivity.kt
â””â”€â”€ MyMuzicApp.kt          <- Composable root App + NavHost


/////
Client ID spotity
c227a0aaa5d54c4881c1ad98e8dad3ec

Client secret
bad18f3d1fb2479e9a954a036f111af0


//// cáº¥u trÃºc app 
ðŸ  1. Home Screen
Tá»”NG QUÃT
Má»¥c tiÃªu: LÃ  trung tÃ¢m hiá»ƒn thá»‹ ná»™i dung chÃ­nh, tÃ­ch há»£p thÃªm tÃ­nh nÄƒng profile vÃ  Ä‘iá»u khiá»ƒn nhanh nháº¡c.

ThÃ nh pháº§n chÃ­nh:

ðŸ”¹ Header:

Avatar ngÆ°á»i dÃ¹ng (áº¥n vÃ o Ä‘á»ƒ má»Ÿ trang profile hoáº·c settings).

ChÃ o buá»•i sÃ¡ng/chiá»u (tÃ¹y thá»i gian).

ðŸ”¹ Recently Played (láº¥y tá»« Spotify GET /me/player/recently-played)

ðŸ”¹ Top Tracks & Artists (dÃ¹ng GET /me/top/artists, GET /me/top/tracks)

ðŸ”¹ Quick Controls:

Nháº¡c Ä‘ang phÃ¡t gáº§n Ä‘Ã¢y + nÃºt Play/Pause.

Seekbar Ä‘Æ¡n giáº£n.

TÃªn bÃ i hÃ¡t + artist.
ðŸŽ§ MÃ€N HÃŒNH HOME â€“ Cáº¤U TRÃšC CHI TIáº¾T
ðŸŽ¯ Má»¥c tiÃªu chÃ­nh:
ChÃ o Ä‘Ã³n ngÆ°á»i dÃ¹ng

Hiá»ƒn thá»‹ ná»™i dung Ä‘Æ°á»£c cÃ¡ nhÃ¢n hÃ³a (theo API Spotify)

Truy cáº­p nhanh Ä‘áº¿n cÃ¡c pháº§n nhÆ° Profile, Player, Track Ä‘ang nghe

ðŸ“¦ ThÃ nh pháº§n UI chÃ­nh:
1. ðŸ” Header:
Avatar ngÆ°á»i dÃ¹ng (Spotify profile image) â†’ khi nháº¥n sáº½ má»Ÿ Profile

TÃªn ngÆ°á»i dÃ¹ng

NÃºt tÃ¬m kiáº¿m (cÃ³ thá»ƒ Ä‘iá»u hÆ°á»›ng sang Explore hoáº·c má»Ÿ Search inline)

2. ðŸŽ¶ "Tiáº¿p tá»¥c nghe":
Hiá»ƒn thá»‹ danh sÃ¡ch track hoáº·c album user Ä‘ang nghe dá»Ÿ

API: GET https://api.spotify.com/v1/me/player/recently-played

3. ðŸ’¡ Gá»£i Ã½ cÃ¡ nhÃ¢n hÃ³a:
Section: "Äá» xuáº¥t cho báº¡n"

API: GET https://api.spotify.com/v1/recommendations

CÃ³ thá»ƒ dÃ¹ng genres hoáº·c top tracks cá»§a user lÃ m input

4. ðŸ’½ Album / Playlist yÃªu thÃ­ch:
Láº¥y tá»« GET https://api.spotify.com/v1/me/albums vÃ  .../playlists

5. ðŸ”Š TrÃ¬nh phÃ¡t mini (Mini Player):
Náº¿u Ä‘ang nghe bÃ i hÃ¡t, hiá»‡n 1 thanh á»Ÿ dÆ°á»›i:

TÃªn bÃ i hÃ¡t

Artist

NÃºt play/pause

Khi nháº¥n vÃ o sáº½ má»Ÿ full player (hoáº·c Ä‘iá»u hÆ°á»›ng sang 1 composable full-screen player)

ðŸ’¬ Luá»“ng logic:
Khi má»Ÿ Home:

Láº¥y access token tá»« local storage hoáº·c request má»›i náº¿u háº¿t háº¡n

Gá»i cÃ¡c API: recently-played, recommendations, playlists, profile

Render UI theo thá»© tá»±: Header â†’ Sections

Náº¿u chÆ°a Ä‘Äƒng nháº­p â†’ chuyá»ƒn sang mÃ n SignIn (tuá»³ cáº¥u trÃºc)

ðŸ›  Ká»¹ thuáº­t:
NÃªn dÃ¹ng:

Paging 3 (náº¿u section nhiá»u dá»¯ liá»‡u)

StateFlow Ä‘á»ƒ cáº­p nháº­t theo thá»i gian thá»±c

Retrofit + Interceptor Ä‘á»ƒ gáº¯n token vÃ o headers

UI: Jetpack Compose



ðŸ” 2. Explore Screen
Tá»”NG QUÃT
Má»¥c tiÃªu: Cho phÃ©p ngÆ°á»i dÃ¹ng tÃ¬m kiáº¿m vÃ  khÃ¡m phÃ¡ nháº¡c má»›i.

ThÃ nh pháº§n chÃ­nh:

ðŸ”¹ SearchBar (dÃ¹ng GET /search?q=...)

CÃ³ thá»ƒ tÃ¬m theo track, artist, album.

ðŸ”¹ Category Slider (Pop, EDM, Chill,... dÃ¹ng GET /browse/categories)

ðŸ”¹ New Releases (dÃ¹ng GET /browse/new-releases)

ðŸ”¹ Featured Playlists (dÃ¹ng GET /browse/featured-playlists)

ðŸ” MÃ€N HÃŒNH EXPLORE â€“ Cáº¤U TRÃšC CHI TIáº¾T
ðŸŽ¯ Má»¥c tiÃªu chÃ­nh:
GiÃºp ngÆ°á»i dÃ¹ng khÃ¡m phÃ¡ nháº¡c má»›i theo chá»§ Ä‘á», thá»ƒ loáº¡i, mood, nghá»‡ sÄ© hot...

Táº¡o cáº£m giÃ¡c "khÃ¡m phÃ¡ khÃ´ng giá»›i háº¡n" nhÆ° Spotify hoáº·c Zing MP3

ðŸ“¦ ThÃ nh pháº§n UI:
1. ðŸ”Ž Thanh TÃ¬m kiáº¿m (Search Bar):
NgÆ°á»i dÃ¹ng nháº­p tá»« khoÃ¡ (tÃªn bÃ i hÃ¡t, nghá»‡ sÄ©, albumâ€¦)

Khi nháº­p sáº½ gá»i:

bash
Sao chÃ©p
Chá»‰nh sá»­a
GET https://api.spotify.com/v1/search?q={keyword}&type=track,artist,album
CÃ³ thá»ƒ chuyá»ƒn sang mÃ n SearchResultScreen (hoáº·c inline dropdown)

2. ðŸ§© Thá»ƒ loáº¡i (Genres):
Hiá»ƒn thá»‹ cÃ¡c thá»ƒ loáº¡i nhÆ° Pop, Rock, EDM, Jazz...

API:

bash
Sao chÃ©p
Chá»‰nh sá»­a
GET https://api.spotify.com/v1/recommendations/available-genre-seeds
Nháº¥n vÃ o 1 genre â†’ navigate sang GenreDetailScreen â†’ hiá»ƒn thá»‹ cÃ¡c track/playlist liÃªn quan

3. ðŸ§  Mood hoáº·c Context Cards (TÃ¹y chá»n):
VÃ­ dá»¥: "Táº­p trung", "ThÆ° giÃ£n", "Táº­p gym", "LÃ£ng máº¡n"...

Spotify khÃ´ng cÃ³ API mood trá»±c tiáº¿p, nhÆ°ng báº¡n cÃ³ thá»ƒ giáº£ láº­p báº±ng playlist theo mood:

bash
Sao chÃ©p
Chá»‰nh sá»­a
GET https://api.spotify.com/v1/browse/categories
hoáº·c dÃ¹ng:

bash
Sao chÃ©p
Chá»‰nh sá»­a
GET https://api.spotify.com/v1/browse/featured-playlists
4. ðŸ“ˆ Top Charts / Trending:
VÃ­ dá»¥: "Top Vietnam", "Top Global"

API:

bash
Sao chÃ©p
Chá»‰nh sá»­a
GET https://api.spotify.com/v1/browse/categories/{category_id}/playlists
hoáº·c dÃ¹ng featured playlists

5. ðŸ‘¨â€ðŸŽ¤ Nghá»‡ sÄ© ná»•i báº­t / má»›i ná»•i (Optional):
API: KhÃ´ng cÃ³ cá»¥ thá»ƒ, nhÆ°ng báº¡n cÃ³ thá»ƒ láº¥y tá»« trending hoáº·c hardcode artist ID vÃ o app náº¿u cáº§n

ðŸ’¡ UX Detail:
CÃ¡c item cÃ³ thá»ƒ hiá»ƒn thá»‹ theo card:

HÃ¬nh áº£nh (playlist / genre / artist)

TÃªn

Khi nháº¥n â†’ má»Ÿ mÃ n má»›i chi tiáº¿t theo loáº¡i dá»¯ liá»‡u

ðŸ’¬ Logic hoáº¡t Ä‘á»™ng:
Khi vÃ o mÃ n Explore:

Gá»i API Ä‘á»ƒ láº¥y danh sÃ¡ch genre

Gá»i danh sÃ¡ch playlist ná»•i báº­t

CÃ³ thá»ƒ gá»i thÃªm recommended playlists

Khi user chá»n genre, playlist, artist â†’ má»Ÿ mÃ n chi tiáº¿t tÆ°Æ¡ng á»©ng (cÃ³ thá»ƒ reuse cÃ¹ng 1 mÃ n cho táº¥t cáº£)


ðŸ“š 3. Library Screen

Tá»”NG QUÃT

Má»¥c tiÃªu: Hiá»ƒn thá»‹ cÃ¡c bÃ i hÃ¡t, playlist vÃ  album mÃ  ngÆ°á»i dÃ¹ng Ä‘Ã£ lÆ°u.

ThÃ nh pháº§n chÃ­nh:

ðŸ”¹ Your Playlists (GET /me/playlists)

ðŸ”¹ Saved Tracks (GET /me/tracks)

ðŸ”¹ Saved Albums (GET /me/albums)

ðŸ”¹ Lá»c theo loáº¡i ná»™i dung (playlist, track, album)

ðŸ“š MÃ€N HÃŒNH LIBRARY â€“ CHI TIáº¾T
ðŸŽ¯ Má»¥c tiÃªu:
Cho phÃ©p ngÆ°á»i dÃ¹ng quáº£n lÃ½:

BÃ i hÃ¡t Ä‘Ã£ thÃ­ch (Liked Songs)

Playlist cá»§a chÃ­nh há»

Album & nghá»‡ sÄ© Ä‘Ã£ lÆ°u

(Optional) Lá»‹ch sá»­ nghe gáº§n Ä‘Ã¢y

Táº¥t cáº£ Ä‘á»u gá»i Ä‘Æ°á»£c tá»« Spotify Web API â€” nhÆ°ng cáº§n token ngÆ°á»i dÃ¹ng, khÃ´ng pháº£i client credentials.

ðŸ“¦ ThÃ nh pháº§n UI:
1. ðŸ‘¤ ThÃ´ng tin tÃ i khoáº£n (tÃ¹y chá»n)
Avatar + tÃªn + nÃºt "Xem há»“ sÆ¡"

DÃ¹ng:

bash
Sao chÃ©p
Chá»‰nh sá»­a
GET https://api.spotify.com/v1/me
2. â¤ï¸ BÃ i hÃ¡t yÃªu thÃ­ch (Liked Songs)
TÃªn: "Liked Songs" hoáº·c "BÃ i hÃ¡t Ä‘Ã£ thÃ­ch"

Gá»i API:

bash
Sao chÃ©p
Chá»‰nh sá»­a
GET https://api.spotify.com/v1/me/tracks
Tráº£ vá» list bÃ i hÃ¡t user Ä‘Ã£ "tháº£ tim"

3. ðŸ“‚ Playlist cá»§a tÃ´i
Gá»i:

bash
Sao chÃ©p
Chá»‰nh sá»­a
GET https://api.spotify.com/v1/me/playlists
Má»—i playlist cÃ³ áº£nh, tÃªn, sá»‘ lÆ°á»£ng bÃ i hÃ¡t

4. ðŸ“€ Album Ä‘Ã£ lÆ°u
Gá»i:

bash
Sao chÃ©p
Chá»‰nh sá»­a
GET https://api.spotify.com/v1/me/albums
5. ðŸŽ¤ Nghá»‡ sÄ© Ä‘Ã£ theo dÃµi
Gá»i:

bash
Sao chÃ©p
Chá»‰nh sá»­a
GET https://api.spotify.com/v1/me/following?type=artist
6. ðŸ•’ Lá»‹ch sá»­ nghe gáº§n Ä‘Ã¢y (náº¿u muá»‘n)
Gá»i:

bash
Sao chÃ©p
Chá»‰nh sá»­a
GET https://api.spotify.com/v1/me/player/recently-played
âš ï¸ API nÃ y cáº§n scope user-read-recently-played, nÃªn chá»‰ hoáº¡t Ä‘á»™ng náº¿u user Ä‘Ã£ login qua OAuth Ä‘Ãºng cÃ¡ch.




ðŸ” Luá»“ng Ä‘Äƒng nháº­p vá»›i Spotify báº±ng PKCE
Khi ngÆ°á»i dÃ¹ng má»Ÿ á»©ng dá»¥ng vÃ  nháº¥n nÃºt "ÄÄƒng nháº­p vá»›i Spotify", á»©ng dá»¥ng sáº½ thá»±c hiá»‡n quy trÃ¬nh Ä‘Äƒng nháº­p theo chuáº©n PKCE nhÆ° sau:

Táº¡o code_verifier vÃ  code_challenge
á»¨ng dá»¥ng táº¡o má»™t chuá»—i ngáº«u nhiÃªn gá»i lÃ  code_verifier, sau Ä‘Ã³ dÃ¹ng SHA-256 Ä‘á»ƒ bÄƒm chuá»—i nÃ y vÃ  chuyá»ƒn káº¿t quáº£ sang dáº¡ng base64url, táº¡o thÃ nh code_challenge.

Má»Ÿ trang Ä‘Äƒng nháº­p Spotify
á»¨ng dá»¥ng Ä‘iá»u hÆ°á»›ng ngÆ°á»i dÃ¹ng Ä‘áº¿n trang á»§y quyá»n cá»§a Spotify (https://accounts.spotify.com/authorize), kÃ¨m theo cÃ¡c tham sá»‘ nhÆ° client_id, redirect_uri, code_challenge, response_type=code, vÃ  cÃ¡c quyá»n (scope) mÃ  á»©ng dá»¥ng yÃªu cáº§u.
NgÆ°á»i dÃ¹ng sáº½ Ä‘Äƒng nháº­p Spotify vÃ  Ä‘á»“ng Ã½ cáº¥p quyá»n.

Spotify chuyá»ƒn hÆ°á»›ng trá»Ÿ láº¡i á»©ng dá»¥ng kÃ¨m theo mÃ£ authorization code
Sau khi ngÆ°á»i dÃ¹ng Ä‘á»“ng Ã½, Spotify sáº½ redirect vá» redirect_uri mÃ  á»©ng dá»¥ng Ä‘Ã£ Ä‘Äƒng kÃ½ ( com.example.mymuzic://callback) kÃ¨m theo tham sá»‘ code=.... á»¨ng dá»¥ng sáº½ láº¥y mÃ£ nÃ y Ä‘á»ƒ thá»±c hiá»‡n bÆ°á»›c tiáº¿p theo.

Äá»•i mÃ£ authorization code láº¥y access token
á»¨ng dá»¥ng gá»­i má»™t HTTP POST request Ä‘áº¿n https://accounts.spotify.com/api/token, vá»›i cÃ¡c thÃ´ng tin: client_id, grant_type=authorization_code, code (vá»«a nháº­n Ä‘Æ°á»£c), redirect_uri, vÃ  code_verifier ban Ä‘áº§u.
Náº¿u thÃ nh cÃ´ng, Spotify sáº½ tráº£ vá» access_token (vÃ  thÆ°á»ng lÃ  cáº£ refresh_token).

LÆ°u token vÃ  chuyá»ƒn sang trang chÃ­nh (Home)
á»¨ng dá»¥ng lÆ°u access_token Ä‘á»ƒ sá»­ dá»¥ng cho cÃ¡c láº§n gá»i Spotify API sau nÃ y, vÃ­ dá»¥: láº¥y thÃ´ng tin ngÆ°á»i dÃ¹ng, phÃ¡t nháº¡c, truy cáº­p playlist,... Sau Ä‘Ã³ á»©ng dá»¥ng sáº½ chuyá»ƒn ngÆ°á»i dÃ¹ng sang trang chÃ­nh (Home screen) vÃ  sá»­ dá»¥ng token Ä‘Ã£ nháº­n Ä‘á»ƒ gá»i cÃ¡c API cáº§n thiáº¿t.

// cháº¡y nháº¡c spotify remote ( code tham kháº£o)
package com.yourdomain.yourapp;

import android.os.Bundle;
import android.support.v7.app.AppCompatActivity;

import android.util.Log;

import com.spotify.android.appremote.api.ConnectionParams;
import com.spotify.android.appremote.api.Connector;
import com.spotify.android.appremote.api.SpotifyAppRemote;

import com.spotify.protocol.client.Subscription;
import com.spotify.protocol.types.PlayerState;
import com.spotify.protocol.types.Track;

class MainActivity : AppCompatActivity() {

    private val clientId = "ad0911afa57949bba362003f601876b2"
    private val redirectUri = "https://com.spotify.android.spotifysdkkotlindemo/callback"
    private var spotifyAppRemote: SpotifyAppRemote? = null

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)
    }

    override fun onStart() {
        super.onStart()
        val connectionParams = ConnectionParams.Builder(clientId)
            .setRedirectUri(redirectUri)
            .showAuthView(true)
            .build()

        SpotifyAppRemote.connect(this, connectionParams, object : Connector.ConnectionListener {
            override fun onConnected(appRemote: SpotifyAppRemote) {
                spotifyAppRemote = appRemote
                Log.d("MainActivity", "Connected! Yay!")
                // Now you can start interacting with App Remote
                connected()
            }

            override fun onFailure(throwable: Throwable) {
                Log.e("MainActivity", throwable.message, throwable)
                // Something went wrong when attempting to connect! Handle errors here
            }
        })
    }

    private fun connected() {
        spotifyAppRemote?.let {
            // Play a playlist
            val playlistURI = "spotify:playlist:37i9dQZF1DX2sUQwD7tbmL"
            it.playerApi.play(playlistURI)
            // Subscribe to PlayerState
            it.playerApi.subscribeToPlayerState().setEventCallback {
                val track: Track = it.track
                Log.d("MainActivity", track.name + " by " + track.artist.name)
            }
        }

    }

    override fun onStop() {
        super.onStop()
        spotifyAppRemote?.let {
            SpotifyAppRemote.disconnect(it)
        }

    }
}